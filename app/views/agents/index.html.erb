<h1>Agents Monitor</h1>



<%= @agent_groups.each do |group| %>

  <h2>Group <%= group.name %></h2>
  <h3>Group id: <%= group.oid %></h3>

  <table id="<%= group.oid %>" class="tablesorter">
    <thead>
    <tr>
      <th>Agent Id</th>
      <th>Agent Type</th>
      <th>Status</th>
      <th>Step (sec)</th>
      <th>Last Iteration</th>

    </tr>
    </thead>
    <tbody>

    <%= group.getAgents.each do |agent| %>

      <tr>
        <td><%= agent.oid %> </td>
        <td><%= agent.type %></td>
        <td><%= agent.status %></td>
        <td><%= group.delay %></td>
        <td id="last-execution-<%= agent.oid %>">
          <%= agent.last_execution_time_in_seconds < 0 ? "n/a" : agent.last_execution_time_in_seconds %> sec ago
        </td>
      </tr>
    <% end %>
    </tbody>
  </table>


<% end %>


<script type="text/javascript">

  $(document).ready(function() {
      $(".tablesorter").tablesorter();

      var intervalId = setInterval(function() {
        $.ajax({
          url: 'agents/refresh_time',
          accept: 'js'
        });
      }, 2000);
    }
  );



</script>



