<div class=" row-fluid">

  <div class='span5 sandbox'>

    <div class="row-fluid">
      <div class="span12">
        <h3>WORKLOAD SANDBOX</h3>
      </div>
    </div>

    <div class="row-fluid">
      <div class="span2 btn-group">
        <%= button_tag "new group", :class => 'btn btn-primary', :onclick => "newGroup();" %>
      </div>

      <div class="input-prepend offset1 span9">
        <%= button_tag "to benchmark", :class => 'btn', :type => "button", :id => 'create-static-profile-with-group' %>
        <input id="appendedInputButton" class="span6" type="text" placeholder="with duration (in minutes)">
      </div>
    </div>

    <br/>

    <div class="row-fluid">
      <div id='agent-groups' class="span12">
        <%= render 'agent_groups/index' %>
      </div>
    </div>

  </div>

  <div class='span7 sandbox'>
    <div class="row-fluid">
      <div class="span12">
        <h3>BENCHMARKS</h3>
      </div>
    </div>

    <div class="row-fluid">
      <div class="input-prepend span4 btn-low">
        <%= button_tag "create", :class => 'btn', :type => "button", :id => 'create-benchmark' %>
        <input id="benchmark_name" class="span9" type="text" placeholder="benchmark name">
      </div>


      <div class="span2">
        <h4>or select an</h4>
      </div>
      <div class="span4 btn-low">
        <%= select_tag "current_benchmark_id", options_for_select(@profiles), :prompt => "existing benchmark" %>
      </div>
    </div>

    <div id="current_profile_details" class="row-fluid">
      <%= render 'shared/profile_details' %>
    </div>
    <%= render '/shared/new_static_profile' %>
    <%= render '/shared/edit_static_profile' %>
  </div>


</div>


<div id="new-group" style="display: none;">
  <%= form_for :agent_group, :url => agent_groups_path(@agent_group), :remote => true, :html => {:id => :new_agent_group} do |f| %>
    <label for="name">name</label>
    <%= f.text_field :name, :class => "" %>
    <br/>

    <label for="type">agents type</label>
    <%= f.select :agents_type, AGENT_TYPES.map { |at| [at.sub(/Agent$/, '').downcase, at] }, {}, :class => "" %>
    <br/><br/>

    <label for="name">agents <span id="agents-selected-new">0</span></label>
    <%= hidden_field_tag 'agent_group[agents]' %>
    <div class="agents-slider slider" rel="new"></div>
    <br/>

    <label for="name">delay <span id="delay-selected-new">0</span> (ms)</label>
    <%= f.hidden_field :delay %>
    <div class="delay-slider slider" rel="new"></div>


  <% end %>
</div>

<script>
  $(document).ready(function() {
    $('#create-static-profile-with-group').on('click', function() {
      $.ajax({
        url: 'static_profiles/create_with_group', 
        type: 'POST',
        data: {'duration': $('#appendedInputButton').val()}
      }).done(function(details) {
        $('#current_profile_details').html(details);
      });
    });

    $('#create-benchmark').on('click', function() {
      $.ajax({
        url: 'create_benchmark', 
        type: 'PUT',
        data: {'name': $('#benchmark_name').val()}
      }).done(function(details) {
        $('#current_profile_details').html(details);
      });              
    });

    $('#current_benchmark_id').on('change', function() {
      $.ajax({
        url: 'update_profile',
        type: 'PUT',
        data: {'current_profile_id': $(this).val()}
      }).done(function(details) {
        $('#current_profile_details').html(details);
      });
    });

  });
</script>

